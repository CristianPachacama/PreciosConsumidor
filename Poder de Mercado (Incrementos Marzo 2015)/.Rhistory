Items = IPCprod$Producto
# Items = IPChist$ITEM
items = IPCprod$Abrebiatura
ListItems = data.frame(Productos = Items , Abreviaturas = items)
colnames(IPC) = items
IPC = data.frame(Fecha=rownames(IPC),IPC)
#Aniadimos Identificador para le tiempo "t" (para la regresion)
Tmp = data.frame(Fecha = IPC$Fecha, Tiempo=1:length(IPC$Fecha))
#Consolidamos en una sola BASE (Por producto) ------------------
a=c()
b=c()
pval=c()
names(IPC)=c('Fecha',items)
View(IPC)
View(IPCprod)
IPC[100:140,]
for(k in 1:116){
producto=k
IPCaux = IPC[,c(1,producto+1)]
BDD = Tmp %>% inner_join(IPCaux)
#Regresion IPC(Producto) - GINI  -------------------------------
#Modelo por producto
modelo = lm( log(eval(as.name(items[producto])) )~log(Tiempo), data= BDD)
print(names(IPCaux)[2])
resumen = (summary(modelo))
a[k] = modelo$coefficients[1]
b[k] = modelo$coefficients[2]
pval[k] = resumen$coefficients[2,4]
}
tabla = data.frame(Productos = Items,a,b,pval)
Items
Items = IPCprod$Producto
Items
#Consolidamos en una sola BASE (Por producto) ------------------
a=c()
b=c()
pval=c()
names(IPC)=c('Fecha',items)
IPC = IPC[100:140,]
for(k in 1:118){
producto=k
IPCaux = IPC[,c(1,producto+1)]
BDD = Tmp %>% inner_join(IPCaux)
#Regresion IPC(Producto) - GINI  -------------------------------
#Modelo por producto
modelo = lm( log(eval(as.name(items[producto])) )~log(Tiempo), data= BDD)
print(names(IPCaux)[2])
resumen = (summary(modelo))
a[k] = modelo$coefficients[1]
b[k] = modelo$coefficients[2]
pval[k] = resumen$coefficients[2,4]
}
tabla = data.frame(Productos = Items,a,b,pval)
Prank = cut(tabla$pval,breaks = c(0,0.001,0.01,0.05,0.1,1),labels = c("***","**","*","."," ") )
tabla$Prank = Prank
tabla = ListItems %>% inner_join(tabla)
View(tabla)
tabla = ListItems %>% inner_join(tabla) %>% arrange(desc(b))
View(tabla)
#Grafico de Series --------------------------------------------
library(dygraphs)
graf_series = function(BDDts){
aux = BDDts
dygraph(aux, main = "Grafico Conjunto",group = 'grupoIndices')%>%
dyAxis('y',label='Series')%>%
dyHighlight(highlightSeriesBackgroundAlpha = 0.3)%>%
dyLegend(show= "follow",width = 400)
}
names(IPC) = c("Fecha",items)
View(tabla)
as.character(tabla$Abreviaturas[1:10])
IPCSaltos = IPC[,c("Fecha",as.character(tabla$Abreviaturas[1:10]))]
View(IPC)
load("Data/DatosAux.RData")
h=1
nivel = c('Nacional'=1,
'Región Sierra'=2,
'Región Costa'=3,
'Guayaquil'=4,
'Esmeraldas'=5,
'Machala'=6,
'Manta'=7,
'Santo Domingo'=8,
'Quito'=9,
'Loja'=10,
'Cuenca'=11,
'Ambato'=12)
IPChist = read_excel("Data/ipc_ind_nac.xls",sheet = as.numeric(nivel[h]), skip = 4)
IPChist = IPChist[,-dim(IPChist)[2]]
Nombres[2] = "Producto"
names(IPChist) = Nombres
IPChist = IPChist[-c(1,dim(IPChist)[1] , dim(IPChist)[1]-1) , ]
IPCprod = inner_join(Productos,IPChist)
#Datos de IPC ---------------------------------------
# IPChist = read_csv("Data/IPChistorico.csv")
IPC = t(as.matrix(IPCprod[,-c(1:3)]))
Items = IPCprod$Producto
# Items = IPChist$ITEM
items = IPCprod$Abrebiatura
ListItems = data.frame(Productos = Items , Abreviaturas = items)
colnames(IPC) = items
IPC = data.frame(Fecha=rownames(IPC),IPC)
#Aniadimos Identificador para le tiempo "t" (para la regresion)
Tmp = data.frame(Fecha = IPC$Fecha, Tiempo=1:length(IPC$Fecha))
#Consolidamos en una sola BASE (Por producto) ------------------
a=c()
b=c()
pval=c()
names(IPC)=c('Fecha',items)
IPC = IPC[100:140,]
for(k in 1:118){
producto=k
IPCaux = IPC[,c(1,producto+1)]
BDD = Tmp %>% inner_join(IPCaux)
#Regresion IPC(Producto) - GINI  -------------------------------
#Modelo por producto
modelo = lm( log(eval(as.name(items[producto])) )~log(Tiempo), data= BDD)
print(names(IPCaux)[2])
resumen = (summary(modelo))
a[k] = modelo$coefficients[1]
b[k] = modelo$coefficients[2]
pval[k] = resumen$coefficients[2,4]
}
tabla = data.frame(Productos = Items,a,b,pval)
Prank = cut(tabla$pval,breaks = c(0,0.001,0.01,0.05,0.1,1),labels = c("***","**","*","."," ") )
tabla$Prank = Prank
tabla = ListItems %>% inner_join(tabla) %>% arrange(desc(b))
#Grafico de Series --------------------------------------------
library(dygraphs)
graf_series = function(BDDts){
aux = BDDts
dygraph(aux, main = "Grafico Conjunto",group = 'grupoIndices')%>%
dyAxis('y',label='Series')%>%
dyHighlight(highlightSeriesBackgroundAlpha = 0.3)%>%
dyLegend(show= "follow",width = 400)
}
names(IPC) = c("Fecha",items)
IPC
items
names(IPC) = c("Fecha",items)
IPCSaltos = IPC[,c("Fecha",as.character(tabla$Abreviaturas[1:10]))]
IPC
names(IPC)
items
# Items = IPChist$ITEM
items = as.character(IPCprod$Abrebiatura)
names(IPC) = c("Fecha",items)
IPCSaltos = IPC[,c("Fecha",as.character(tabla$Abreviaturas[1:10]))]
BDD3 = Tmp %>% #inner_join(Gini) %>%
inner_join(IPCaux3) #%>% inner_join(PIB)
BDD3 = Tmp %>% #inner_join(Gini) %>%
inner_join(IPCSaltos) #%>% inner_join(PIB)
BDDSaltos = Tmp %>% #inner_join(Gini) %>%
inner_join(IPCSaltos) #%>% inner_join(PIB)
TBDDSaltos = ts(BDDSaltos[,-(1:3)], start = c(2005, 1),frequency = 12)
graf_series(TBDDSaltos)
BDDSaltos
IPCSaltos
tabla
tabla$Productos[1:10]
as.character(tabla$Productos[1:10])
as.character(tabla$Productos[1:15])
IPCSaltos = IPC[,c("Fecha",as.character(tabla$Abreviaturas[1:15]))]
BDDSaltos = Tmp %>% #inner_join(Gini) %>%
inner_join(IPCSaltos) #%>% inner_join(PIB)
TBDDSaltos = ts(BDDSaltos[,-(1:3)], start = c(2005, 1),frequency = 12)
graf_series(TBDDSaltos)
View(BDDSaltos)
View(BDDSaltos)
View(BDDSaltos)
TBDDSaltos = ts(BDDSaltos[,-(1:3)], start = c(2013, 4),frequency = 12)
graf_series(TBDDSaltos)
load("Data/DatosAux.RData")
h=1
nivel = c('Nacional'=1,
'Región Sierra'=2,
'Región Costa'=3,
'Guayaquil'=4,
'Esmeraldas'=5,
'Machala'=6,
'Manta'=7,
'Santo Domingo'=8,
'Quito'=9,
'Loja'=10,
'Cuenca'=11,
'Ambato'=12)
IPChist = read_excel("Data/ipc_ind_nac.xls",sheet = as.numeric(nivel[h]), skip = 4)
IPChist = IPChist[,-dim(IPChist)[2]]
Nombres[2] = "Producto"
names(IPChist) = Nombres
IPChist = IPChist[-c(1,dim(IPChist)[1] , dim(IPChist)[1]-1) , ]
IPCprod = inner_join(Productos,IPChist)
#Datos de IPC ---------------------------------------
# IPChist = read_csv("Data/IPChistorico.csv")
IPC = t(as.matrix(IPCprod[,-c(1:3)]))
Items = IPCprod$Producto
# Items = IPChist$ITEM
items = as.character(IPCprod$Abrebiatura)
ListItems = data.frame(Productos = Items , Abreviaturas = items)
colnames(IPC) = items
IPC = data.frame(Fecha=rownames(IPC),IPC)
#Aniadimos Identificador para le tiempo "t" (para la regresion)
Tmp = data.frame(Fecha = IPC$Fecha, Tiempo=1:length(IPC$Fecha))
#Consolidamos en una sola BASE (Por producto) ------------------
a=c()
b=c()
pval=c()
names(IPC)=c('Fecha',items)
#!!!!!!!!!!!!!!!!!!!!!!
IPC = IPC[100:130,]
for(k in 1:118){
producto=k
IPCaux = IPC[,c(1,producto+1)]
BDD = Tmp %>% inner_join(IPCaux)
#Regresion IPC(Producto) - GINI  -------------------------------
#Modelo por producto
modelo = lm( log(eval(as.name(items[producto])) )~log(Tiempo), data= BDD)
print(names(IPCaux)[2])
resumen = (summary(modelo))
a[k] = modelo$coefficients[1]
b[k] = modelo$coefficients[2]
pval[k] = resumen$coefficients[2,4]
}
tabla = data.frame(Productos = Items,a,b,pval)
Prank = cut(tabla$pval,breaks = c(0,0.001,0.01,0.05,0.1,1),labels = c("***","**","*","."," ") )
tabla$Prank = Prank
tabla = ListItems %>% inner_join(tabla) %>% arrange(desc(b))
#Grafico de Series --------------------------------------------
library(dygraphs)
graf_series = function(BDDts){
aux = BDDts
dygraph(aux, main = "Grafico Conjunto",group = 'grupoIndices')%>%
dyAxis('y',label='Series')%>%
dyHighlight(highlightSeriesBackgroundAlpha = 0.3)%>%
dyLegend(show= "follow",width = 400)
}
# Por grupo
names(IPC) = c("Fecha",items)
IPCSaltos = IPC[,c("Fecha",as.character(tabla$Abreviaturas[1:15]))]
BDDSaltos = Tmp %>% #inner_join(Gini) %>%
inner_join(IPCSaltos) #%>% inner_join(PIB)
TBDDSaltos = ts(BDDSaltos[,-(1:3)], start = c(2013, 4),frequency = 12)
graf_series(TBDDSaltos)
as.character(tabla$Productos[1:15])
as.character(tabla$Productos[1:15])
library(dygraphs)
library(dplyr)
library(readxl)
library(zoo)
IPC
IPCSaltos = IPC[,c("Fecha",as.character(tabla$Abreviaturas[1:15]))]
BDDSaltos = Tmp %>% #inner_join(Gini) %>%
inner_join(IPCSaltos) #%>% inner_join(PIB)
TBDDSaltos = ts(BDDSaltos[,-(1:3)], start = c(2013, 4),frequency = 12)
graf_series(TBDDSaltos)
setwd("D:/OneDrive - Escuela Politécnica Nacional/PUCE/A. Investigaciones/PreciosConsumidor/Modelamiento/Poder de Mercado (Incrementos Marzo 2015)")
load("Data/DatosAux.RData")
h=1
nivel = c('Nacional'=1,
'Región Sierra'=2,
'Región Costa'=3,
'Guayaquil'=4,
'Esmeraldas'=5,
'Machala'=6,
'Manta'=7,
'Santo Domingo'=8,
'Quito'=9,
'Loja'=10,
'Cuenca'=11,
'Ambato'=12)
IPChist = read_excel("Data/ipc_ind_nac.xls",sheet = as.numeric(nivel[h]), skip = 4)
IPChist = IPChist[,-dim(IPChist)[2]]
Nombres[2] = "Producto"
names(IPChist) = Nombres
IPChist = IPChist[-c(1,dim(IPChist)[1] , dim(IPChist)[1]-1) , ]
IPCprod = inner_join(Productos,IPChist)
#Datos de IPC ---------------------------------------
# IPChist = read_csv("Data/IPChistorico.csv")
IPC = t(as.matrix(IPCprod[,-c(1:3)]))
Items = IPCprod$Producto
# Items = IPChist$ITEM
items = as.character(IPCprod$Abrebiatura)
ListItems = data.frame(Productos = Items , Abreviaturas = items)
colnames(IPC) = items
IPC = data.frame(Fecha=rownames(IPC),IPC)
#Aniadimos Identificador para le tiempo "t" (para la regresion)
Tmp = data.frame(Fecha = IPC$Fecha, Tiempo=1:length(IPC$Fecha))
#Consolidamos en una sola BASE (Por producto) ------------------
a=c()
b=c()
pval=c()
names(IPC)=c('Fecha',items)
#!!!!!!!!!!!!!!!!!!!!!!
IPC = IPC[114:130,]
for(k in 1:118){
producto=k
IPCaux = IPC[,c(1,producto+1)]
BDD = Tmp %>% inner_join(IPCaux)
#Regresion IPC(Producto) - GINI  -------------------------------
#Modelo por producto
modelo = lm( log(eval(as.name(items[producto])) )~log(Tiempo), data= BDD)
print(names(IPCaux)[2])
resumen = (summary(modelo))
a[k] = modelo$coefficients[1]
b[k] = modelo$coefficients[2]
pval[k] = resumen$coefficients[2,4]
}
tabla = data.frame(Productos = Items,a,b,pval)
Prank = cut(tabla$pval,breaks = c(0,0.001,0.01,0.05,0.1,1),labels = c("***","**","*","."," ") )
tabla$Prank = Prank
tabla = ListItems %>% inner_join(tabla) %>% arrange(desc(b))
#Grafico de Series --------------------------------------------
library(dygraphs)
graf_series = function(BDDts){
aux = BDDts
dygraph(aux, main = "Grafico Conjunto",group = 'grupoIndices')%>%
dyAxis('y',label='Series')%>%
dyHighlight(highlightSeriesBackgroundAlpha = 0.3)%>%
dyLegend(show= "follow",width = 400)
}
# Por grupo
names(IPC) = c("Fecha",items)
IPCSaltos = IPC[,c("Fecha",as.character(tabla$Abreviaturas[1:15]))]
BDDSaltos = Tmp %>% #inner_join(Gini) %>%
inner_join(IPCSaltos) #%>% inner_join(PIB)
TBDDSaltos = ts(BDDSaltos[,-(1:3)], start = c(2013, 4),frequency = 12)
graf_series(TBDDSaltos)
IPC
TBDDSaltos = ts(BDDSaltos[,-(1:3)], start = c(2014, 6),frequency = 12)
graf_series(TBDDSaltos)
as.character(tabla$Productos[1:15])
#!!!!!!!!!!!!!!!!!!!!!!
IPC = IPC[118:130,]
for(k in 1:118){
producto=k
IPCaux = IPC[,c(1,producto+1)]
BDD = Tmp %>% inner_join(IPCaux)
#Regresion IPC(Producto) - GINI  -------------------------------
#Modelo por producto
modelo = lm( log(eval(as.name(items[producto])) )~log(Tiempo), data= BDD)
print(names(IPCaux)[2])
resumen = (summary(modelo))
a[k] = modelo$coefficients[1]
b[k] = modelo$coefficients[2]
pval[k] = resumen$coefficients[2,4]
}
tabla = data.frame(Productos = Items,a,b,pval)
Prank = cut(tabla$pval,breaks = c(0,0.001,0.01,0.05,0.1,1),labels = c("***","**","*","."," ") )
load("Data/DatosAux.RData")
h=1
nivel = c('Nacional'=1,
'Región Sierra'=2,
'Región Costa'=3,
'Guayaquil'=4,
'Esmeraldas'=5,
'Machala'=6,
'Manta'=7,
'Santo Domingo'=8,
'Quito'=9,
'Loja'=10,
'Cuenca'=11,
'Ambato'=12)
IPChist = read_excel("Data/ipc_ind_nac.xls",sheet = as.numeric(nivel[h]), skip = 4)
IPChist = IPChist[,-dim(IPChist)[2]]
Nombres[2] = "Producto"
names(IPChist) = Nombres
IPChist = IPChist[-c(1,dim(IPChist)[1] , dim(IPChist)[1]-1) , ]
IPCprod = inner_join(Productos,IPChist)
#Datos de IPC ---------------------------------------
# IPChist = read_csv("Data/IPChistorico.csv")
IPC = t(as.matrix(IPCprod[,-c(1:3)]))
Items = IPCprod$Producto
# Items = IPChist$ITEM
items = as.character(IPCprod$Abrebiatura)
ListItems = data.frame(Productos = Items , Abreviaturas = items)
colnames(IPC) = items
IPC = data.frame(Fecha=rownames(IPC),IPC)
#Aniadimos Identificador para le tiempo "t" (para la regresion)
Tmp = data.frame(Fecha = IPC$Fecha, Tiempo=1:length(IPC$Fecha))
#Consolidamos en una sola BASE (Por producto) ------------------
a=c()
b=c()
pval=c()
names(IPC)=c('Fecha',items)
#!!!!!!!!!!!!!!!!!!!!!!
IPC = IPC[118:130,]
for(k in 1:118){
producto=k
IPCaux = IPC[,c(1,producto+1)]
BDD = Tmp %>% inner_join(IPCaux)
#Regresion IPC(Producto) - GINI  -------------------------------
#Modelo por producto
modelo = lm( log(eval(as.name(items[producto])) )~log(Tiempo), data= BDD)
print(names(IPCaux)[2])
resumen = (summary(modelo))
a[k] = modelo$coefficients[1]
b[k] = modelo$coefficients[2]
pval[k] = resumen$coefficients[2,4]
}
tabla = data.frame(Productos = Items,a,b,pval)
Prank = cut(tabla$pval,breaks = c(0,0.001,0.01,0.05,0.1,1),labels = c("***","**","*","."," ") )
tabla$Prank = Prank
tabla = ListItems %>% inner_join(tabla) %>% arrange(desc(b))
#Grafico de Series --------------------------------------------
library(dygraphs)
graf_series = function(BDDts){
aux = BDDts
dygraph(aux, main = "Grafico Conjunto",group = 'grupoIndices')%>%
dyAxis('y',label='Series')%>%
dyHighlight(highlightSeriesBackgroundAlpha = 0.3)%>%
dyLegend(show= "follow",width = 400)
}
names(IPC) = c("Fecha",items)
IPCSaltos = IPC[,c("Fecha",as.character(tabla$Abreviaturas[1:15]))]
BDDSaltos = Tmp %>% #inner_join(Gini) %>%
inner_join(IPCSaltos) #%>% inner_join(PIB)
TBDDSaltos = ts(BDDSaltos[,-(1:3)], start = c(2014, 6),frequency = 12)
graf_series(TBDDSaltos)
as.character(tabla$Productos[1:15])
BDDSaltos
IPCSaltos
IPCSaltos = IPC[,c("Fecha",as.character(tabla$Abreviaturas[1:15]))]
BDDSaltos = Tmp %>% #inner_join(Gini) %>%
inner_join(IPCSaltos) #%>% inner_join(PIB)
TBDDSaltos = ts(BDDSaltos[,-(1:3)], start = c(2014, 10),frequency = 12)
graf_series(TBDDSaltos)
as.character(tabla$Productos[1:15])
sort(as.character(tabla$Productos[1:15]))
shiny::runApp('D:/OneDrive - Escuela Politécnica Nacional/PUCE/A. Investigaciones/PreciosConsumidor/Modelamiento/App Cluster IPC')
setwd("D:/OneDrive - Escuela Politécnica Nacional/PUCE/A. Investigaciones/PreciosConsumidor/Modelamiento/Poder de Mercado (Incrementos Marzo 2015)/Data")
library(readxl)
library(readxl)
BDDSaltos = read_excel("Data/SeriesSaltos.xlsx")
setwd("D:/OneDrive - Escuela Politécnica Nacional/PUCE/A. Investigaciones/PreciosConsumidor/Modelamiento/Poder de Mercado (Incrementos Marzo 2015)")
BDDSaltos = read_excel("Data/SeriesSaltos.xlsx")
View(BDDSaltos)
BDDSaltos = read_excel("Data/SeriesSaltos.xlsx")
View(BDDSaltos)
#Grafico de Series   -----------------------
graf_series = function(IPC,ind = NULL,fecha = fecha0){
if(is.null(ind)){
aux = IPC[,-1]
}else{
aux = IPC[,ind]
}
aux = ts(aux,start = fecha[c(2,1)] , frequency = 12)
graf=dygraph(data = aux, main = "IPC Productos")%>%
# dyAxis("x", label=names(metric)) %>%
# dyAxis('y',label='')%>%
dyHighlight(highlightSeriesBackgroundAlpha = 0.3)#%>%
# dyLegend(show= "follow",width = 400)
return(graf)
}
BDDSaltos
BDDSaltos[,-1]
BDDSaltosTs = ts(BDDSaltos[,-1], start = c(2005, 1),frequency = 12)
View(BDDSaltosTs)
BDDSaltosTs
graf_series(IPC,ind,fecha = c(1,2005))
graf_series(BDDSaltosTs,fecha = c(1,2005))
graf_series = function(IPC,ind = NULL,fecha = fecha0){
if(is.null(ind)){
aux = IPC[,-1]
}else{
aux = IPC[,ind]
}
aux = ts(aux,start = fecha[c(2,1)] , frequency = 12)
graf=dygraph(data = aux, main = "IPC Productos")%>%
# dyAxis("x", label=names(metric)) %>%
# dyAxis('y',label='')%>%
dyHighlight(highlightSeriesBackgroundAlpha = 0.3)#%>%
# dyLegend(show= "follow",width = 400)
return(graf)
}
graf_series(BDDSaltosTs,fecha = c(1,2005))
library(dplyr)
graf_series(BDDSaltosTs,fecha = c(1,2005))
library(dygraphs)
graf_series(BDDSaltosTs,fecha = c(1,2005))
#Graficos TSstudio -------------------------
ts_plot(BDDSaltosTs,
title = "IPC Saltos Marzo 2015",
type = "single")
library(TSstudio)
#Graficos TSstudio -------------------------
ts_plot(BDDSaltosTs,
title = "IPC Saltos Marzo 2015",
type = "single")
#Graficos TSstudio -------------------------
ts_plot(BDDSaltosTs,
title = "IPC Saltos Marzo 2015",
type = "single",
Xgrid = TRUE,
Ygrid = TRUE,
slider = TRUE)
BDDSaltosTs
#Graficos TSstudio -------------------------
ts_plot(BDDSaltosTs,
title = "IPC Saltos Marzo 2015",
type = "single",
width = 0.5,
Xgrid = TRUE,
Ygrid = TRUE,
slider = TRUE)
#Graficos TSstudio -------------------------
ts_plot(BDDSaltosTs,
title = "IPC Saltos Marzo 2015",
type = "single",
width = 1,
Xgrid = TRUE,
Ygrid = TRUE,
slider = TRUE)
